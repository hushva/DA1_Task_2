---
title: "Team C Data Report"
output: pdf_document
---

```{r setup, include=FALSE}
pacman::p_load(pacman, dplyr, GGally, ggplot, ggplot2, ggthemes, 
               ggvis, httr, lubridate, plotly, rio, rmarkdown, shiny, 
               stringr, tidyr, moments) 
library(tidyverse)
library(xtable)
data_in <- "C:/Users/ADMIN/Desktop/CEU/R_codes/DA1_Task_2/raw/"
rest_data <- read.csv(paste0(data_in,"pizza_restaurants_raw.csv"))

rest_data <- rename(rest_data,
                    margherita_price = `Margherita.Price..HUF.`,
                    pizza_only = `Pizza.only..binary.`,
                    cola_price = `X0.5L.Cola.Price..HUF.`,
                    online_rating = `Online.rating`,
                    distance = `Distance.to.CEU..KM.`)

f_rest_data <- filter(rest_data,!is.na(cola_price))

rest_summary <- f_rest_data %>%  summarise( 
      mean = mean( margherita_price ),
      median = median( margherita_price ),
      sd = sd( margherita_price  ),
      min = min( margherita_price ),
      max = max( margherita_price ),
      iq_range = IQR( margherita_price ),
      skew = skewness(margherita_price), 
      numObs = sum( !is.na( margherita_price )))

testing <- f_rest_data %>% 
   select(Region, margherita_price) %>% 
   group_by(Region) %>% 
   summarise(mean_margherita_price = mean(margherita_price),
             se_margherita_price =1/sqrt(n())*sd(margherita_price),
             num_obs=n())
 testing <- mutate(testing, t_stat=mean_margherita_price / se_margherita_price)
```


# Owerview 
## Data Collection Process 

The data collection process took place in a primarily online setting. Main sources included searches through Google and NetPincer websites. The restaurants were selected in random fashion. Restaurants outside of Budapest, were selected from cities with the population ranging from 60 thousand to 200 thousand, in an attempt to increase coverage. The number of observations was limited to three to avoid bias. The cola beverage was chosen as a variable in order to avoid missing values. Due to high popularity, the assumption was that, Cola is available almost anywhere in some shape or form. In addition, no distinction was made between nominal brands of cola (e.g. Pepsi-Cola vs. Coca-Cola). In order to manage the geographic restrictions and the limited opening hours, a binary variable was selected. The variable measures if the observed restaurant serves pizza only or has additional items on the menu (e.g. pasta, soup, non-Italian cuisine, etc.). In case of further research, the variable can be used as a conditioning variable, to explore correlation between it and other variables. For example, it might provide some insight into the correlation between quality of pizza and the restaurant being a pizzeria only. 

## Main Issues and Challenges 

* Some of the restaurants don’t have an online presence, which makes it harder to record observations and thus increases the chance of incomplete coverage. 
* Most of the places don’t have a uniform menu features, meaning some of the places don’t indicate the pizza size while others don’t have cola on the menu. This resulted in missing values for some observations. 
* Due to the pandemic and geographic restrictions, the available variable pool was decreased. For example, there was no opportunity to visit all of the restaurants and actually try the pizza, thus qualitative variables such as taste, crust texture, etc. were not available for analysis.  


## Table 1.1 Descriptive statistics for pizza price in Hungary 
```{r, fig.width=5, fig.height=2, echo=FALSE, warning=F, message=F, warning=FALSE}
f_rest_data %>%
  ggplot(aes(x = margherita_price)) +
  geom_histogram()+
  theme_gray()+
  labs(x="Price", y="Frequency", title = "Margherita Pizza Price Distribution")
```

## Table 1.2 Descriptive statistics for cola price in Hungary 
```{r, fig.width=5, fig.height=2, echo=FALSE}
f_rest_data %>%
  ggplot(aes(x=cola_price)) +
  geom_histogram()+
  theme_gray()+
  labs(x="Price", y="Frequency", title = "Cola Price Distribution")
```

## Figure 2.1 Pizza Price Dsitribution Conditioned on Region
```{r, fig.width=5, fig.height=2.5, echo=FALSE}
 hist(f_rest_data$margherita_price [f_rest_data$Region == "Capital"],
      xlim = c(0, 2500),
      main = "Distribution of Pizza Prices in the Capital",
      xlab = "Price of Pizza in HUF",
      col = "#83BFFF")
```

## Figure 2.1 Pizza Price Dsitribution Conditioned on Region
```{r, fig.width=5, fig.height=2.5, echo=FALSE}
  hist(f_rest_data$margherita_price [f_rest_data$Region == "Countryside"],
       xlim = c(0, 2500),
       main = "Distribution of Pizza Prices in the Countryside",
       xlab = "Price of Pizza in HUF",
       col = "#83BFFF")
```

## Hypothesis test for margherita prices in Capital vs Countryside
```{r, echo=FALSE, warning=F, message=F, warning=FALSE}
testing 
```

We could conclude based on the t-stats that the average price of margherita pizza in the capital and in the countryside is not the same. 

## Summary 

## Figure 1.1 Pizza and Cola Price Distributions
```{r, fig.width=5, fig.height=3, echo=FALSE, warning=F, message=F, warning=FALSE}
ggplot( data = f_rest_data ) +
    geom_density( aes( x = margherita_price ) , color = "blue"  , alpha = 0.1 ) +
    geom_density( aes( x = f_rest_data$cola_price )  , color = "red" , alpha = 0.1 ) +
   labs(x = "Price in HUF",
         y = "Relative Frequency" ) 
```
